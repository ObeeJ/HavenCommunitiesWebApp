<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Environment Variables Test</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .card {
            background: white;
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: 600;
            margin-left: 10px;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
        }
        .code {
            background: #f4f4f4;
            padding: 12px;
            border-radius: 4px;
            font-family: monospace;
            margin: 10px 0;
            overflow-x: auto;
        }
        h1 { color: #155eef; margin-top: 0; }
        h2 { color: #333; border-bottom: 2px solid #155eef; padding-bottom: 8px; }
        .instruction {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 12px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="card">
        <h1>üîç Environment Variables Test</h1>
        <p>This page helps you verify that your environment variables are loaded correctly.</p>
    </div>

    <div class="card">
        <h2>Environment Variables Status</h2>
        <div id="env-status">
            <p>Loading...</p>
        </div>
    </div>

    <div class="card">
        <h2>Troubleshooting Steps</h2>
        <div class="instruction">
            <strong>If you see errors above:</strong>
            <ol>
                <li>Make sure you have a <code>.env</code> file in your project root</li>
                <li>Check that it contains:
                    <div class="code">VITE_SUPABASE_URL=your_url_here<br>VITE_SUPABASE_ANON_KEY=your_key_here</div>
                </li>
                <li><strong>IMPORTANT:</strong> Stop the dev server (Ctrl+C) and restart it with <code>npm run dev</code></li>
                <li>Refresh this page</li>
            </ol>
        </div>
    </div>

    <div class="card">
        <h2>Quick Fix Guide</h2>
        <p><strong>Step 1:</strong> Create/Edit .env file in project root</p>
        <div class="code">VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your_anon_key_here</div>
        
        <p><strong>Step 2:</strong> Stop and restart server</p>
        <div class="code"># Press Ctrl+C to stop
npm run dev</div>
        
        <p><strong>Step 3:</strong> Refresh this page</p>
    </div>

    <script type="module">
        function checkEnvVars() {
            const statusDiv = document.getElementById('env-status');
            let html = '';

            try {
                // Check if import.meta.env exists
                if (typeof import.meta === 'undefined') {
                    html += '<p>‚ùå <strong>ERROR:</strong> import.meta is undefined</p>';
                    html += '<p>This should not happen in a Vite project. Make sure you\'re running with Vite.</p>';
                } else if (!import.meta.env) {
                    html += '<p>‚ùå <strong>ERROR:</strong> import.meta.env is undefined</p>';
                    html += '<p>Vite is not loading environment variables correctly.</p>';
                } else {
                    html += '<p>‚úÖ <strong>import.meta.env is available</strong></p>';
                    
                    // Check VITE_SUPABASE_URL
                    const url = import.meta.env.VITE_SUPABASE_URL;
                    if (url) {
                        if (url.includes('your_supabase_url_here') || url.includes('placeholder')) {
                            html += `<p>‚ö†Ô∏è VITE_SUPABASE_URL: <span class="status error">PLACEHOLDER VALUE</span></p>`;
                            html += `<div class="code">${url}</div>`;
                            html += '<p>You need to replace this with your actual Supabase URL</p>';
                        } else {
                            html += `<p>‚úÖ VITE_SUPABASE_URL: <span class="status success">SET</span></p>`;
                            html += `<div class="code">${url.substring(0, 30)}...</div>`;
                        }
                    } else {
                        html += '<p>‚ùå VITE_SUPABASE_URL: <span class="status error">NOT SET</span></p>';
                    }
                    
                    // Check VITE_SUPABASE_ANON_KEY
                    const key = import.meta.env.VITE_SUPABASE_ANON_KEY;
                    if (key) {
                        if (key.includes('your_supabase_anon_key_here') || key.includes('placeholder')) {
                            html += `<p>‚ö†Ô∏è VITE_SUPABASE_ANON_KEY: <span class="status error">PLACEHOLDER VALUE</span></p>`;
                            html += '<p>You need to replace this with your actual Supabase anon key</p>';
                        } else {
                            html += `<p>‚úÖ VITE_SUPABASE_ANON_KEY: <span class="status success">SET</span></p>`;
                            html += `<div class="code">${key.substring(0, 30)}...${key.substring(key.length - 10)}</div>`;
                        }
                    } else {
                        html += '<p>‚ùå VITE_SUPABASE_ANON_KEY: <span class="status error">NOT SET</span></p>';
                    }

                    // Check MODE
                    const mode = import.meta.env.MODE;
                    html += `<p>‚ÑπÔ∏è Mode: <strong>${mode || 'unknown'}</strong></p>`;

                    // Check DEV
                    const dev = import.meta.env.DEV;
                    html += `<p>‚ÑπÔ∏è Development: <strong>${dev ? 'Yes' : 'No'}</strong></p>`;

                    // Overall status
                    if (url && key && !url.includes('placeholder') && !key.includes('placeholder')) {
                        html += '<hr><h3 style="color: green;">‚úÖ All environment variables are configured correctly!</h3>';
                        html += '<p>Your app should work properly now.</p>';
                    } else {
                        html += '<hr><h3 style="color: red;">‚ùå Environment variables need attention</h3>';
                        html += '<p>Follow the troubleshooting steps below.</p>';
                    }
                }
            } catch (error) {
                html += `<p>‚ùå <strong>ERROR:</strong> ${error.message}</p>`;
                html += '<p>This indicates a problem with the build setup.</p>';
            }

            statusDiv.innerHTML = html;
        }

        // Run the check
        checkEnvVars();
    </script>
</body>
</html>
